<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Testing Pelican Migration</title>
        <link rel="stylesheet" href="http://cranmer.github.io/theme/css/main.css" />
        <link href="http://cranmer.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Theory And Practice Atom Feed" />

        <!-- for ipython notebook -->

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://cranmer.github.io/">Theory And Practice </a></h1>
                <nav><ul>
                    <li><a href="http://cranmer.github.io/">Home</a></li>
                    <li><a href="http://cranmer.github.io/pages/impactstory.html">ImpactStory</a></li>
                    <li><a href="http://cranmer.github.io/pages/in-the-news.html">Media & Outreach</a></li>
                    <li><a href="http://cranmer.github.io/pages/projects.html">Projects</a></li>
                    <li class="active"><a href="http://cranmer.github.io/category/blog.html">Blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://cranmer.github.io/Testing-Pelican-Migration.html" rel="bookmark"
           title="Permalink to Testing Pelican Migration">Testing Pelican Migration</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-03-21T10:53:00">
                Fri 21 March 2014
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="http://cranmer.github.io/author/kyle-cranmer.html">Kyle Cranmer</a>
        </address>
<p>In <a href="http://cranmer.github.io/category/blog.html">Blog</a>. </p>

</footer><!-- /.post-info -->      <p>So, I'm taking the leap and migrating from Wordpress to pelican.</p>
<p>Testing:</p>
<ul>
<li>Here is <a href="{filename}../inspired-by-the-higgs-a-step-forward-in-open-access.md">a link</a> to a local file</li>
<li>liquid {% img %} tag working    </li>
<li>{% youtube %} tag working, but<ul>
<li>does it work with start/end time?</li>
<li>does it support change to height/width of iframe?</li>
</ul>
</li>
<li>render_math works: $e^{i\pi}+1 = 0$</li>
<li>simple inline <code>code</code> markup</li>
<li>a little block of python with pygments</li>
</ul>
<div class="highlight"><pre>    <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
        <span class="k">print</span> <span class="s">&#39;welcome to Pelican&#39;</span>
</pre></div>


<p>Notes on getting notebook to work</p>
<ul>
<li>ipython command line worked, but import IPython wasn't working. Was a virtualenv issue, did a pip install (very fast) and all good now. </li>
<li>Adding the EXTRA_HEADER doesn't work until the _nb_header.html is generated. If there is no check for the file, the devserver has problems. </li>
<li>I wasn't sure where to put the {% if EXTRA_HEADER %} code, but found that it should go in themes/base.html. Unfortunately, the _nb_header isn't playing well with the pelican-bootstrap3 theme... the notebook is styled, but the menu, buttons, and headers of the rest of the page are modified.</li>
</ul>
<p>{% notebook Spirograph3d.ipynb cells[1:9] %}</p>
<hr />
<p>
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>This notebook is inspired by the</em> <a href="http://jakevdp.github.io/blog/2013/05/12/embedding-matplotlib-animations/"><em>blog post</em></a> <em>on</em> <a href="http://jakevdp.github.io"><em>Pythonic Perambulations</em></a>.</p>
<p><em>License:</em> <a href="http://opensource.org/licenses/BSD-3-Clause"><em>BSD</em></a> <em>(C) 2014, Kyle Cranmer.</em> <em>Feel free to use, distribute, and modify with the above attribution.</em></p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>When teaching Physics I at NYU I gave a challenging problem to my students to use change of coordinates with rotations and translations to derive the parametric equation for a spirograph. They also had to solve for the velocity and acceleration. It was hard, but a lot of students liked it. In the process, I made some <a href="http://www.flickr.com/photos/hoonynoo/2159185452/in/photostream/">pretty plots</a> and posted them to Flickr. When I saw Jake's awesome animation examples, I had to try it out with something novel.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[1]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="o">%</span><span class="k">pylab</span> <span class="n">inline</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
Populating the interactive namespace from numpy and matplotlib

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll create a function that will save an animation and embed it in an html string. Note that this will require ffmpeg or mencoder to be installed on your system. For reasons entirely beyond my limited understanding of video encoding details, this also requires using the libx264 encoding for the resulting mp4 to be properly embedded into HTML5.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[2]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>

<span class="n">VIDEO_TAG</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;&lt;video controls&gt;</span>
<span class="s"> &lt;source src=&quot;data:video/x-m4v;base64,{0}&quot; type=&quot;video/mp4&quot;&gt;</span>
<span class="s"> Your browser does not support the video tag.</span>
<span class="s">&lt;/video&gt;&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">anim_to_html</span><span class="p">(</span><span class="n">anim</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">anim</span><span class="p">,</span> <span class="s">&#39;_encoded_video&#39;</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s">&#39;.mp4&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span><span class="n">extra_args</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;-vcodec&#39;</span><span class="p">,</span> <span class="s">&#39;libx264&#39;</span><span class="p">,</span> <span class="s">&#39;-pix_fmt&#39;</span><span class="p">,</span> <span class="s">&#39;yuv420p&#39;</span><span class="p">])</span>
            <span class="n">video</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">anim</span><span class="o">.</span><span class="n">_encoded_video</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;base64&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">VIDEO_TAG</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">_encoded_video</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>With this HTML function in place, we can use IPython's HTML display tools to create a function which will show the video inline:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[3]:
</div>
<div class="input_area box-flex1">
<div class="highlight-ipynb"><pre class="ipynb"><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="k">def</span> <span class="nf">display_animation</span><span class="p">(</span><span class="n">anim</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">_fig</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">anim_to_html</span><span class="p">(</span><span class="n">anim</span><span class="p">))</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now define a class for the spirograph.</p>
</div></p>
<p>How do I style the literal line below?</p>
<p>{% include_code learnEmbedding.py lang:python learnEmbedding %}</p>
<!--

test notebook

--><script type= "text/javascript">
    if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = 'https:' == document.location.protocol
                ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
                : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
</script>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="http://www.quantumdiaries.org/">Quantum Diaries</a></li>
                            <li><a href="http://www.quantumdiaries.org/author/kyle-cranmer/">Me @ Quantum Diaries</a></li>
                            <li><a href="http://www.math.columbia.edu/~woit/wordpress/">Not Even Wrong</a></li>
                            <li><a href="http://twistedphysics.typepad.com/cocktail_party_physics/">Cocktail Party Physics</a></li>
                            <li><a href="http://resonaances.blogspot.com/">Résonaances</a></li>
                            <li><a href="http://profmattstrassler.com/">Matt Strassler</a></li>
                            <li><a href="http://gordonwatts.wordpress.com/">Life as a physicist</a></li>
                            <li><a href="http://www.science20.com/physics">Tommaso Dorigo</a></li>
                            <li><a href="http://blogs.discovermagazine.com/cosmicvariance/">Cosmic Variance</a></li>
                            <li><a href="http://muon.wordpress.com/">Collider Blog</a></li>
                            <li><a href="http://www.symmetrymagazine.org/breaking">Symmetry Breaking</a></li>
                            <li><a href="http://blog.inspirehep.net/">INSPIRE</a></li>
                            <li><a href="http://datapub.cdlib.org/">Data Pub</a></li>
                            <li><a href="http://hoggresearch.blogspot.com/">Hogg’s Research</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://cranmer.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/kylecranmer">twitter</a></li>
                            <li><a href="http://github.com/cranmer">github</a></li>
                            <li><a href="http://www.linkedin.com/in/kylecranmer">linkedin</a></li>
                            <li><a href="https://plus.google.com/106689822196584540592/posts">google+</a></li>
                            <li><a href="http://www.flickr.com/photos/hoonynoo/">flickr</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>